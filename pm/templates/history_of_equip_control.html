<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<style>

#controlformtitle{
        border-width: 8px 8px 0px 8px;
        border-color: #6F6F6F;
        border-style: solid;
        margin-top:30px;
        margin-left:7px;
        padding-top:0.5cm;
        padding-left:4cm;
        font-size: 32px;
        font-family: arial;
        font-weight:bold;
        width:22.6cm;
}

#controlformtext{
        border-width: 0px 8px 0px 8px;
        border-color: #6F6F6F;
        border-style: solid;
        position:relative; left:7px;
        font-size: 16px;
        font-family: arial;
        height:1cm;
        padding-left:1.6cm;
        width:25cm;
}

#equipinfo{
        -webkit-print-color-adjust: exact !important;
        border-width: 0px 8px 0px 8px;
        border-color: #6F6F6F;
        border-style: solid;
        position:relative; left:7px;
    	font-family: arial;
        font-size:14px;
        color:black;
        width:26.6cm;
}
#equipinfo_table{
        border-collapse:collapse;
        -webkit-print-color-adjust: exact !important;
}
.table1{
        background-color: #EEEEEE;
        width:5cm;
        height:30px;
        font-weight:bold;
        -webkit-print-color-adjust: exact !important;
}
.table2{
        padding-left:5px;
        background-color: white;
        width:8.3cm;
}


#pmcontrolformtitle{
        border-width: 0px 8px 0px 8px;
        border-color: #6F6F6F;
        border-style: solid;
    	font-family: arial;
        font-size:14px;
        position:relative; left:7px;
        width:26.6cm;
        background-color:#6F6F6F;
        color:white;
        height:30px;
        z-index:10;
         -webkit-print-color-adjust: exact !important;
}
#pmcontrolformdesc{
        border-width: 0px 8px 0px 8px;
        border-color: #6F6F6F;
        border-style: solid;
        position:relative; left:7px;
        width:26.6cm;
}

#pmsheet{
        border-width: 0px 8px 0px 8px;
        border-color: #6F6F6F;
        border-style: solid;
        position:relative; left:7px;
    	font-family: arial;
        font-size:14px;
        height:20px;
        width:26.6cm;
        background-color:#6F6F6F;
        color:white;
        height:30px;
        -webkit-print-color-adjust: exact !important;
}
#pmsheethead{
        height:30px;
    	font-family: arial;
        font-size:14px;
}
#pmsheetbody{
        border-width: 0px 8px 0px 8px;
        border-color: #6F6F6F;
        border-style: solid;
        position:relative; left:7px;
        width:26.6cm;
}

#pmsheettable{
        font-size:14px;
    	font-family: arial;
        border:1px solid #6F6F6F;
        border-collapse:collapse;
        -webkit-print-color-adjust: exact !important;
}

.s1{width:150px;}
.s2{width:400px;}
.s3{width:360px;}
.s4{width:240px;}
.s1-1{width:150px;
      height:30px;}
.s2-1{width:400px;}
.s3-1{width:360px;}
.s4-1{width:240px;}
#pmcontrolform_approval{
        border-width: 0px 8px 0px 8px;
        border-color: #6F6F6F;
        border-style: solid;
    	font-family: arial;
        font-size:14px;
        position:relative; left:7px;
        width:26.6cm;
        background-color:#6F6F6F;
        color:white;
        z-index:10;
         -webkit-print-color-adjust: exact !important;
}


#pmcontrolformtop{
        height:30px;
    	font-family: arial;
        font-size:14px;
        }

#pmcontrolform_approval_table{
        border-width: 0px 8px 8px 8px;
        border-color: #6F6F6F;
        border-style: solid;
        position:relative; left:7px;
        width:26.6cm;}

#pmcontrolformapproval{
        border:1px solid #6F6F6F;
        border-collapse:collapse;
        font-size:14px;
        font-family: arial;
        -webkit-print-color-adjust: exact !important;
        }

#pmtable{
        border:1px solid #6F6F6F;
        border-collapse:collapse;
        font-size:14px;
        font-family: arial;
        -webkit-print-color-adjust: exact !important;
}

.c1{width:100px; height:30px;}
.c2{width:70px;}
.c3{width:400px;}
.c4{width:280px;}
.c5{width:200px;}
.c6{width:100px;}
.c7{width:130px;}

.c1-1{width:100px; height:30px;}
.c2-1{width:70px;}
.c3-1{width:400px;}
.c4-1{width:280px;}
.c5-1{width:200px;}
.c6-1{width:100px;}
.c7-1{width:130px;}

.c11{width:300px;
    height:30px;
    background-color: #EEEEEE;
    font-weight:bold;
    -webkit-print-color-adjust: exact !important;
}
.c12{width:350px;
    height:30px;
    background-color:white;}
.c13{width:350px;
    height:30px;
    background-color:white;}
.r1{
    padding-left:450px;
    height:30px;
}
@media print {
  @page {
    size:210mm 297mm;
    margin: 25mm 12mm 25mm 12mm;
  }
  html, body { border:0; margin:0px; padding:0; }
}
</style>
<body>
<div class="border">
</div>


<div id="controlformtitle">
Preventive Maintenance Program Control Form
</div>

<div id="controlformtext">
(To be used initiate additions modifications, or deletions of tasks or equipment to/from the Preventive Maintenance System)
</div>

<div id="equipinfo">
<table id="equipinfo_table" border= "1">
                      {% for equipinfos in equipinfo %}
                      {% for equipinforevs in equipinforev %}
    <tr>
        <td class="table1">
            Control No.
        </td>
        <td class="table2">
            {{equipinfos.controlno}}
        </td>
        <td class="table1">
            Equipment. Name
        </td>
        <td class="table2">
            {{equipinfos.name}}
        </td>
    </tr>
    <tr>
        <td class="table1">
            Model Name
        </td>
        <td class="table2">
            {{equipinfos.model}}
        </td>
        <td class="table1">
            Serial No.
        </td>
        <td class="table2">
            {{equipinfos.serial}}
        </td>
    </tr>
    <tr>
        <td class="table1">
            Manufacturer
        </td>
        <td class="table2">
            {{equipinfos.maker}}
        </td>
        <td class="table1">
            Team
        </td>
        <td class="table2">
            {{equipinfos.team}}
        </td>
    </tr>
    <tr>
        <td class="table1">
            Room Name&nbsp;(Room No.)
        </td>
        <td class="table2">
            {{equipinfos.roomname}}&nbsp;({{equipinfos.roomno}})
        </td>
        <td class="table1">
            Revision Date
        </td>
        <td class="table2">
            {{equipinforevs.revdate}}
        </td>
    </tr>
    <tr>
        <td class="table1">
             Revision No.
        </td>
        <td class="table2">
            Rev.{{equipinforevs.revno}}
        </td>
        <td class="table1">
            Assessment of Period
        </td>
        <td class="table2">
            {{equipinfos.ra}}Month(s)
        </td>
    </tr>
                                 {% endfor %}
                                 {% endfor %}
</table>
</div>

<main>
<div id="pmcontrolformtitle" >
     <table  style="word-break:break-all">
        <thead>
        <tr>
            <td align="center" class="c1">Frequency</td>
            <td align="center" class="c2">A / D</td>
            <td align="center" class="c3">Maintenance Item</td>
            <td align="center" class="c4">Check Standard</td>
            <td align="center" class="c5">Change Information</td>
            <td align="center" class="c6">Start Date</td>
            <td align="center" class="c7">Division</td>
        </tr>
        </thead>
     </table>
</div>

<div id="pmcontrolformdesc">
 <table style="word-break:break-all" border="1" id="pmtable">
     <tbody>
                      {% for controlformdb in controlformdb %}
        <tr>
            <td align="center" class="c1-1">{{controlformdb.freq}}</td> <!--models.py에서 값받아오기-->
            <td align="center" class="c2-1">{{controlformdb.amd}}</td>
            <td align="center" class="c3-1">{{controlformdb.item}}</td>
            <td align="center" class="c4-1">{{controlformdb.check}}</td>
            <td align="center" class="c5-1">{{controlformdb.change}}</td>
            <td align="center" class="c6-1">{{controlformdb.startdate}}</td>
            <td align="center" class="c7-1">{{controlformdb.division}}</td>
            </td>
        </tr>
                             {% endfor %}
        </tbody>
 </table>
</div>

 <div id="pmsheet">
   <table id="pmsheethead">
        <tr>
            <td align="center" class="s1">Frequency</td>
            <td align="center" class="s2">PM Sheet No.</td>
            <td align="center" class="s3">Start Date (Y/M)</td>
            <td align="center" class="s4">Remark</td>
        </tr>
   </table>
 </div>

 <div id="pmsheetbody">
   <table id="pmsheettable"  border="1">
               {% for pmsheetdb in pmsheet %}
     <tr>
            <td align="center" class="s1-1">{{pmsheetdb.freq}}</td>
            <td align="center" class="s2-1">{{pmsheetdb.pmsheetno}}</td>
            <td align="center" class="s3-1">{{pmsheetdb.startdate}}</td>
            <td align="center" class="s4-1"></td>
     </tr>
                   {% endfor %}
   </table>
 </div>


 <div id="pmcontrolform_approval">
 <table style="word-break:break-all" id="pmcontrolformtop">
     <thead>
         <tr>
            <td align="center" class="r1">Review & Approved</td>
        </tr>
     </thead>
 </table>
 </div>
 <div id="pmcontrolform_approval_table">
                {% for equip_appoval in equipinforev%}
 <table style="word-break:break-all" id="pmcontrolformapproval" border="1">
    <tbody>
        <tr>
            <td align="left" class="c11">Prepared by:</td> <!--models.py에서 값받아오기-->
            <td align="center" class="c12">{{equip_appoval.p_name}}</td>
            <td align="center" class="c13">{{equip_appoval.p_date}}</td>
        </tr>
        <tr>
            <td align="left" class="c11">Reviewed by:</td> <!--models.py에서 값받아오기-->
            <td align="center" class="c12">{{equip_appoval.r_name}}</td>
            <td align="center" class="c13">{{equip_appoval.r_date}}</td>
        </tr>
        <tr>
            <td align="left" class="c11">Approved by:</td> <!--models.py에서 값받아오기-->
            <td align="center" class="c12">{{equip_appoval.a_name}}</td>
            <td align="center" class="c13">{{equip_appoval.a_date}}</td>
        </tr>
     </tbody>
 </table>
            {% endfor %}
 </div>
</main>

<script>

             //////////// 기본초기값 불러오기//////////////
     function init(){
             window.resizeTo(800,1000);
             window.print();
             setTimeout("window.close();",500);
             }
      onload=init

</script>

</body>
</html>