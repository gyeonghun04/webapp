<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<style>
workrequesttitle{
        position:fixed;top:64.8px; left:28.8px;
        font-size: 24px;
        font-family: arial;
        font-weight:bold;
}
#equipinfo{
    	font-family: arial;
        font-size:11px;
        position:fixed;top:108px; left:15.36px;
        color:black;
        width:846.7px;
        border:1px solid #6F6F6F;
        border-collapse:collapse;
}
.table1{
        background-color: #EEEEEE;
        width:326.4px;
        height:25px;
        font-weight:bold;
}
.table2{
        background-color: white;
}
.border {
        position:fixed;top:37.8px;
        border:8px solid #6F6F6F;
        width:844.8px;
        height:736.56px;
    }
#workrequesttitle{
    	font-family: arial;
        font-size:11px;
        position:fixed;top:240px; left:15.36px;
        width:846.72px;
        background-color:#6F6F6F;
        color:white;
        height:20px;
}
#workrequestdesc{
        position:fixed; top:260px; left:15.36px;
        font-family: arial;
        font-size:11px;
}
#workrequesttable{
        font-size:11px;
    	font-family: arial;
}
.c1{padding-left:400px;}
.c1-1{width:400px; height:15px;}

#workrequesttitle2{
    	font-family: arial;
        font-size:11px;
        position:fixed;top:675px; left:15.36px;
        width:846.72px;
        background-color:#6F6F6F;
        color:white;
        height:20px;
}
#workrequesttable2{
        position:fixed;top:700px; left:15.36px;
        width:846.72px;
        font-family: arial;
        font-size:11px;
}

#workrequesttitle3{
    	font-family: arial;
        font-size:11px;
        position:fixed;top:734.4px; left:15.36px;
        width:846.72px;
        background-color:#6F6F6F;
        color:white;
        height:20px;
}
#workrequesttable3{
        position:fixed;top:753.84px; left:15.44px;
        width:846.72px;
        font-family: arial;
        font-size:11px;
        border:1px solid #6F6F6F;
        border-collapse:collapse;
}
.req_table1{
        background-color: #EEEEEE;
        width:100px;
        height:25px;
        font-weight:bold;
}
.req_table2{
        background-color: white;
        width:200px;
}
.req_table3{
        background-color: white;
        width:200px;
}
.description_css{
width:835px;
height:402px;
font-size:12px;
font-family: arial;
}
.text_css{
width:270px;
height:16px;
font-size:11px;
font-family: arial;
}
.req_reason_css{
width:300px;
height:18px;
font-size:11px;
font-family: arial;
}
.text_css2{
width:260px;
height:16px;
font-size:11px;
font-family: arial;
}
.text_css3{
width:835px;
height:16px;
font-size:11px;
font-family: arial;
}
.capa_css{
width:220px;
height:16px;
font-size:11px;
font-family: arial;
}
.req_date_na{
margin-left:50px;
}
.pmcheck_submit_css{
position:fixed;top:797.04px; left:806.4px;
font-family: arial;
font-size:12px;
cursor:pointer;
}
.button_css2{
font-family: arial;
font-size:16px;
cursor:pointer
}

#messages_location{
        position:fixed; top:5px;
        font-size:18px;
        font-weight:bold;
        animation-iteration-count:10;
	    animation-duration:1s;
	    animation-name: changecolor;
       	color:white;
}
@keyframes changecolor{
    from{
       	  color:white;    }
    to{
          color:red;    }
}
</style>
<body>
<div class="border">
</div>

{% include "pmchecksheet_workrequest_top.html"%}

<workrequesttitle>
Work Request Form
</workrequesttitle>

<form action="" method="post" name="workrequest">
         {% csrf_token %}
<table id="equipinfo" border= "1">

    <tr>
        <td class="table1">
            Control No.
        </td>
        <td class="table2">
            <input type="text" name="controlno" value="{{controlno}}" class="text_css" onchange="Controlno_upload();" required>
        </td>
        <td class="table1">
            Equipment. Name
        </td>
        <td class="table2">
            <input type="text" name="equipname" value="{{equipname}}" class="text_css" readonly>
        </td>
    </tr>
    <tr>
        <td class="table1">
            Room Name<br>(Room No.)
        </td>
        <td class="table2">
            <input type="text" name="roomname" value="{{roomname}}" class="text_css" readonly><br>
            (<input type="text" name="roomno" value="{{roomno}}" class="text_css2" readonly>)
        </td>
        <td class="table1">
            Type
        </td>
        <td class="table2">
            <input type="radio" name="type" value="BM" {{bm}}>BM&emsp;
            <input type="radio" name="type" value="CM" {{cm}}>CM&emsp;
            <input type="radio" name="type" value="PM" {{pm}}>PM&emsp;
            <input type="radio" name="type" value="IT" {{it}}>IT&emsp;
        </td>
    </tr>
    <tr>
        <td class="table1">
            CAPA. or Deviation No.
        </td>
        <td class="table2">
            <input type="text" name="capa_up" value="{{capa}}" class="capa_css" onchange="Capa_change();" required>
            <input type="checkbox" name="capa_na" onchange="Capa_na_change();">N/A
        </td>
        <td class="table1">
            Team
        </td>
        <td class="table2">
            <input type="text" name="equipteam" value="{{equipteam}}" class="text_css" readonly>
        </td>
    </tr>
    <tr>
        <td class="table1">
            Requestor
        </td>
        <td class="table2">
            <input type="text" name="loginid_up" class="text_css" readonly>
        </td>
        <td class="table1">
            Request Date
        </td>
        <td class="table2">
            <input type="text" name="request_date" class="text_css" readonly>
        </td>
    </tr>
</table>
<div id="workrequesttitle" >
     <table  style="word-break:break-all">
        <thead>
        <tr>
            <td align="center" class="c1">Description</td>
        </tr>
        </thead>
     </table>
</div>
<div id="workrequestdesc">
 <table style="word-break:break-all" id="workrequesttable">
     <tbody>
        <tr>
            <td align="center" class="c1-1">
                <textarea name="description" class="description_css" style="resize:none;" required>{{description}}</textarea>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<div id="workrequesttitle2" >
     <table  style="word-break:break-all">
        <thead>
        <tr>
            <td align="center" class="c2">Attached File</td>
        </tr>
        </thead>
     </table>
</div>
</form>
<div id="workrequesttable2" >
     <table  style="word-break:break-all">
        <thead>

        <tr>
            <td align="center" class="c2-1">
                            {% if url_comp == "Y" %}
            <a href="{{url}}" target="_blank" class="upload_complete_css">Upload_ Complete</a>
                            {%else%}
                <form method="post" enctype="multipart/form-data" class="uploadfile" name="uploadfile">
            {% csrf_token %}
            <input type="hidden" name="loginid">
            <input type="hidden"  name="controlno">
            <input type="hidden"  name="capa">
            <input type="hidden"  name="equipteam">
            <input type="hidden"  name="date">
            <input type="hidden"  name="description">
            <input type="hidden"  name="equipname">
            <input type="hidden"  name="roomname">
            <input type="hidden"  name="roomno">
            <input type="hidden"  name="type">
            <input type="hidden"  name="req_date">
            <input type="hidden"  name="req_reason">
            <input type="file" name="upload_file" id="upload_file" class="button_css1">
            <input type="button" value="Upload" class="button_css2" onclick="Upload_file();"></form>
                            {%endif%}
            </td>
        </tr>
        </thead>
     </table>
</div>

<form action="" method="post" name="workrequest_2">
         {% csrf_token %}
<div id="workrequesttitle3" >
     <table  style="word-break:break-all">
        <thead>
        <tr>
            <td align="center" class="c3">Required Information</td>
        </tr>
        </thead>
     </table>
</div>
 <table style="word-break:break-all" border="1" id="workrequesttable3">
     <tbody>
    <tr>
        <td class="req_table1">
            Date Required
        </td>
        <td class="req_table2">
            <input type="date" name="req_date_up" class="req_date" value="{{req_date_return}}" onchange="Req_date();">
            <input type="checkbox" name="req_date_na" class="req_date_na" {{req_na_return}}>N/A
        </td>
        <td class="req_table1">
            Reason Required
        </td>
        <td class="req_table3">
            <input type="text" name="req_reason_up" value="{{req_reason}}" class="req_reason_css" onchange="Req_reason_change();" required>
            <input type="checkbox" name="req_reason_na" onchange="Req_reason_na_change();">N/A
        </td>
    </tr>
        </tbody>
</table>
    <input type="hidden" value="{{url}}" name="url_up">
</form>
    <input type="button" class="pmcheck_submit_css" value="Submit" onclick="submit_request();">


    <form action="" method="post" name="control_no">
             {% csrf_token %}
        <input type="hidden" name="loginid">
        <input type="hidden" name="controlno"></form>

    <form method="post" name="Submit_request">
            {% csrf_token %}
            <input type="hidden" name="loginid">
            <input type="hidden"  name="controlno">
            <input type="hidden"  name="capa">
            <input type="hidden"  name="equipteam">
            <input type="hidden"  name="date">
            <input type="hidden"  name="description">
            <input type="hidden"  name="equipname">
            <input type="hidden"  name="roomname">
            <input type="hidden"  name="roomno">
            <input type="hidden"  name="url">
            <input type="hidden"  name="type">
            <input type="hidden"  name="req_date">
            <input type="hidden"  name="req_reason"></form>
<script>
 //////////// 기본초기값 불러오기//////////////
     function init(){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!
            var yyyy = today.getFullYear();
            if(dd<10) {
                dd='0'+dd
            }
            if(mm<10) {
                mm='0'+mm
            }
            today = yyyy+'-'+mm+'-'+dd;
            document.workrequest.request_date.value = today;
            loginid = opener.document.getElementById("workloginid").value;
            document.workrequest.loginid_up.value = loginid;
            document.control_no.loginid.value = loginid;
            document.getElementById("logindata").innerHTML=loginid;
            }

      onload=init

 //////////// 파일업로드하기//////////////
            function Upload_file(){
            loginid = opener.document.getElementById("workloginid").value;
            var controlno= document.getElementsByName('controlno')[0].value;
            var capa= document.getElementsByName('capa_up')[0].value;
            var equipteam= document.getElementsByName('equipteam')[0].value;
            var description= document.getElementsByName('description')[0].value;
            var req_date= document.getElementsByName('req_date_up')[0].value;
            var req_reason= document.getElementsByName('req_reason_up')[0].value;
            var date= document.getElementsByName('request_date')[0].value;
            var equipname= document.getElementsByName('equipname')[0].value;
            var roomname= document.getElementsByName('roomname')[0].value;
            var roomno= document.getElementsByName('roomno')[0].value;
                // req_date_na 값보내기
             // req_date_na 값보내기
            if (document.workrequest_2.req_date_na.checked == true){
                document.uploadfile.req_date.value = "N/A";}
            else{document.uploadfile.req_date.value = req_date;}
             // type 값보내기
            var obj_length = document.getElementsByName("type").length;
                for (var i=0; i<obj_length; i++) {
                    if (document.getElementsByName("type")[i].checked == true) {
                        var type = document.getElementsByName("type")[i].value;
                        }
                    }
                // 값보내기
            document.uploadfile.loginid.value = loginid;
            document.uploadfile.controlno.value = controlno;
            document.uploadfile.capa.value = capa;
            document.uploadfile.equipteam.value = equipteam;
            document.uploadfile.description.value = description;
            document.uploadfile.req_reason.value = req_reason;
            document.uploadfile.date.value = date;
            document.uploadfile.equipname.value = equipname;
            document.uploadfile.roomname.value = roomname;
            document.uploadfile.roomno.value = roomno;
            document.uploadfile.req_reason.value = req_reason;
            document.uploadfile.type.value = type;
                // 서버연결
            document.uploadfile.action="workrequest_upload";
            document.uploadfile.submit();
            }

 //////////// 설비정보 불러오기//////////////
              function Controlno_upload(){
            var controlno= document.getElementsByName('controlno')[0].value;
            // 값보내기
            document.control_no.controlno.value = controlno;
            // 서버로 전송
            document.control_no.action="workrequest_controlno";
            document.control_no.submit();
            }

 //////////// Capa입력시 n/a 해제 //////////////
              function Capa_change(){
                 document.getElementsByName('capa_na')[0].checked=false;
              }

 //////////// n/a클릭 시 자동 클릭 //////////////
              function Capa_na_change(){
                if (document.workrequest.capa_na.checked == true){
                document.workrequest.capa_up.value = "N/A";
                }
              }

 //////////// req_reason 입력시 n/a 해제 //////////////
              function Req_reason_change(){
                 document.getElementsByName('req_reason_na')[0].checked=false;
                }

 ////////////  req_reason n/a클릭 시 자동 클릭 //////////////
              function Req_reason_na_change(){
                if (document.workrequest_2.req_reason_na.checked == true){
                document.workrequest_2.req_reason_up.value = "N/A";
                }
              }

  ////////////  req_date 입력 시 자동 변경 //////////////
              function Req_date(){
                 document.getElementsByName('req_date_na')[0].checked=false;
              }

  ////////////  submit //////////////
            function submit_request(){
            loginid = opener.document.getElementById("workloginid").value;
            var controlno= document.getElementsByName('controlno')[0].value;
            var capa= document.getElementsByName('capa_up')[0].value;
            var equipteam= document.getElementsByName('equipteam')[0].value;
            var description= document.getElementsByName('description')[0].value;
            var req_date= document.getElementsByName('req_date_up')[0].value;
            var req_reason= document.getElementsByName('req_reason_up')[0].value;
            var date= document.getElementsByName('request_date')[0].value;
            var equipname= document.getElementsByName('equipname')[0].value;
            var roomname= document.getElementsByName('roomname')[0].value;
            var roomno= document.getElementsByName('roomno')[0].value;
            var url= document.getElementsByName('url_up')[0].value;
             // req_date_na 값보내기
            if (document.workrequest_2.req_date_na.checked == true){
                document.Submit_request.req_date.value = "N/A";}
            else{document.Submit_request.req_date.value = req_date;
            }
             // type 값보내기
            var obj_length = document.getElementsByName("type").length;
                for (var i=0; i<obj_length; i++) {
                    if (document.getElementsByName("type")[i].checked == true) {
                        var type = document.getElementsByName("type")[i].value;
                        }
                    }
             // 값보내기
            document.Submit_request.loginid.value = loginid;
            document.Submit_request.controlno.value = controlno;
            document.Submit_request.capa.value = capa;
            document.Submit_request.equipteam.value = equipteam;
            document.Submit_request.description.value = description;
            document.Submit_request.req_reason.value = req_reason;
            document.Submit_request.date.value = date;
            document.Submit_request.equipname.value = equipname;
            document.Submit_request.roomname.value = roomname;
            document.Submit_request.roomno.value = roomno;
            document.Submit_request.req_reason.value = req_reason;
            document.Submit_request.type.value = type;
            document.Submit_request.url.value = url;
            // 서버연결
            document.Submit_request.action="workrequest_submit";
            document.Submit_request.submit();
            }
</script>
</body>
</html>