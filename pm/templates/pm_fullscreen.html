<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Preventive Maintenance Check Sheet</title>
<style>
@media print{
  @page {
    size:297mm 210mm;
    margin: 10mm 10mm 10mm 10mm;
  }
  html, body { border:0; margin:0px; padding:0; }

.border{
      display:none;}
.print_button{
      display:none;}
.close_button{
    display:none;}

#pmchecksheet{
        border-width: 8px 8px 0px 8px;
        border-color: #6F6F6F;
        border-style: solid;
        margin-top: 35px;
        font-size: 32px;
        font-family: arial;
        font-weight:bold;
        width:297mm;
}

#equipinfo{
        margin-top:17px;
        position:relative; left:10px;
        width:297mm;
    	font-family: arial;
        font-size:12px;
        color:black;
        border:1px solid #6F6F6F;
        border-collapse:collapse;
        -webkit-print-color-adjust: exact !important;
}
.table1{
        -webkit-print-color-adjust: exact !important;
        background-color: #EEEEEE;
        width:17%;
        height:25px;
        font-weight:bold;
}
.table2{
        background-color: white;
        width:30%;
}
#pmchecksheettitle{
        -webkit-print-color-adjust: exact !important;
        position:relative; left:10px;
    	font-family: arial;
        font-size:12px;
        width:297mm;
        background-color:#6F6F6F;
        color:white;
        height:40px;
}
.c1{width:400px;}
.c2{width:300px;}
.c3{width:330px;}
.c4{width:150px;}
.c5{width:350px;}
.c6{width:150px;}
.c7{width:50px;
    -webkit-print-color-adjust: exact !important;
    background-color:#6F6F6F;
    font-size:9px;
    font-family: arial;}
.c8{width:150px;}

#pmchecksheetdesc{
        position:relative; left:10px;
        width:297mm;
}
#pmtable{
        -webkit-print-color-adjust: exact !important;
        border:1px solid #6F6F6F;
        border-collapse:collapse;
        font-size:12px;
        font-family: arial;
}

#usedparthead{
        position:relative; left:9px;
        width:297mm;
    	font-family: arial;
        font-size:11px;
        background-color:#6F6F6F;
        color:white;
        height:40px;
        border:1px solid white;
        border-collapse:collapse;
        z-index:-10;
        -webkit-print-color-adjust: exact !important;
}
#usedpartbody{
        margin-top:20px;
        position:relative; left:10px;
        width:297mm;
        -webkit-print-color-adjust: exact !important;
}
#usedparttop{
    	font-family: arial;
        font-size:11px;
        height:20px;
}
#usedparttable{
        font-size:12px;
    	font-family: arial;
    	border:1px solid #6F6F6F;
        border-collapse:collapse;
        -webkit-print-color-adjust: exact !important;
}

.c1-1{width:380px;}
.c2-1{width:310px;}
.c3-1{width:350px;}
.c5-1{width:350px;}
.c6-1{width:150px;}
.c7-1{width:50px;}
.c8-1{width:150px;}

tr:nth-child(even){
    background-color:#EEEEEE;
    -webkit-print-color-adjust: exact !important;
}

#pmremarktop{
        position:relative; left:10px;
        height:30px;
        width:297mm;
        background-color:#6F6F6F;
        -webkit-print-color-adjust: exact !important;

}
#pmremarkhead{
    	font-family: arial;
        color:white;
        width:297mm;
        font-size:12px;}

#pmremarkbody{
        position:relative; left:10px;
        height:40px;
        width:297mm;
}

#pmremarktable{
        font-size:12px;
    	font-family: arial;
}
#pmremarktable{
        font-size:12px;
    	font-family: arial;
    	border:1px solid #6F6F6F;
        border-collapse:collapse;
        -webkit-print-color-adjust: exact !important;
}
.r1{width:1323px;}
.r2{width:659px;}
.r1-1{width:1323px;
      height:40px;}
.r2-1{width:659px;}

#pmchecksheetapprovaltop{
        position:relative; left:10px;
    	font-family: arial;
        font-size:12px;
        background-color:#6F6F6F;
        color:white;
        padding:1px;
        width:297mm;
        -webkit-print-color-adjust: exact !important;
        }

#pmchecksheetapproval{
        position:relative; left:10px;
        font-family: arial;
        font-size:12px;
        padding:10px;
        width:297mm;
        border:1px solid #6F6F6F;
        border-collapse:collapse;
        -webkit-print-color-adjust: exact !important;
        }
.c11{width:300px;
    height:25px;
    background-color: #EEEEEE;}
.c12{width:300px;
    background-color:white;}
.c13{width:300px;
    background-color:white;}

.u1{width:13.2%;
background-color:#6F6F6F;
-webkit-print-color-adjust: exact !important;
}
.u2{width:17.6%;
background-color:#6F6F6F;
-webkit-print-color-adjust: exact !important;
}
.u3{width:13.3%;
background-color:#6F6F6F;
-webkit-print-color-adjust: exact !important;
}
.u4{width:26.3%;
background-color:#6F6F6F;
-webkit-print-color-adjust: exact !important;
}
.u5{width:10.7%;
background-color:#6F6F6F;
-webkit-print-color-adjust: exact !important;
}
.u6{width:;
background-color:#6F6F6F;
-webkit-print-color-adjust: exact !important;
}

.u1-1{width:244px;
height:25px;}
.u2-1{width:328px;}
.u3-1{width:247px}
.u4-1{width:491px;}
.u5-1{width:198px;}
.u6-1{width:338px;}
}


@media screen{
#pmchecksheet{
        margin-top: 35px;
        margin-left:600px;
        font-size: 40px;
        font-family: arial;
        font-weight:bold;
}
.border {
        position:fixed;top:1.5%; left:0.5%;
        border:8px solid #6F6F6F;
        height:93.5%;
        width:98%;
    }
#equipinfo{
        margin-top:17px;
        position:relative; left:10px;
        width:1882px;
    	font-family: arial;
        font-size:16px;
        color:black;
        border:1px solid #6F6F6F;
        border-collapse:collapse;
}
.table1{
        background-color: #EEEEEE;
        width:17%;
        height:25px;
        font-weight:bold;
}
.table2{
        background-color: white;
        width:30%;
}
#pmchecksheettitle{
        position:relative; left:10px;
    	font-family: arial;
        font-size:16px;
        width:1882px;
        background-color:#6F6F6F;
        color:white;
        height:40px;
}
.c1{width:400px;}
.c2{width:300px;}
.c3{width:330px;}
.c4{width:150px;}
.c5{width:350px;}
.c6{width:150px;}
.c7{width:50px;
    background-color:#6F6F6F;
    font-size:9px;
    font-family: arial;}
.c8{width:150px;}

#pmchecksheetdesc{
        position:relative; left:10px;
        width:1882px;
        height:355px;
        overflow-y:scroll;
}
#pmtable{
        border:1px solid #6F6F6F;
        border-collapse:collapse;
        font-size:16px;
        font-family: arial;
}

#usedparthead{
        position:relative; left:9px;
        width:1883px;
    	font-family: arial;
        font-size:11px;
        background-color:#6F6F6F;
        color:white;
        height:40px;
        border:1px solid white;
        border-collapse:collapse;
        z-index:-10;
}
#usedpartbody{
        margin-top:20px;
        position:relative; left:10px;
        width:1882px;
        height:75px;
        overflow-y:scroll;
}
#usedparttop{
    	font-family: arial;
        font-size:11px;
        height:20px;
}
#usedparttable{
        font-size:16px;
    	font-family: arial;
    	border:1px solid #6F6F6F;
        border-collapse:collapse;
}

.c1-1{width:380px;}
.c2-1{width:310px;}
.c3-1{width:350px;}
.c5-1{width:350px;}
.c6-1{width:150px;}
.c7-1{width:50px;}
.c8-1{width:150px;}

tr:nth-child(even){
    background-color:#EEEEEE;
}

#pmremarktop{
        position:relative; left:10px;
        height:30px;
        width:1882px;
        background-color:#6F6F6F;
}
#pmremarkhead{
    	font-family: arial;
        color:white;
        width:98.1%;
        font-size:16px;}

#pmremarkbody{
        position:relative; left:10px;
        height:40px;
        width:1882px;
}

#pmremarktable{
        font-size:16px;
    	font-family: arial;
}
#pmremarktable{
        font-size:16px;
    	font-family: arial;
    	border:1px solid #6F6F6F;
        border-collapse:collapse;
}
.r1{width:1323px;}
.r2{width:659px;}
.r1-1{width:1323px;
      height:40px;}
.r2-1{width:659px;}

#pmchecksheetapprovaltop{
        position:relative; left:10px;
    	font-family: arial;
        font-size:16px;
        background-color:#6F6F6F;
        color:white;
        padding:1px;
        width:1882px;
        }

#pmchecksheetapproval{
        position:relative; left:10px;
        font-family: arial;
        font-size:16px;
        padding:10px;
        width:1882px;
        border:1px solid #6F6F6F;
        border-collapse:collapse;
        }
.c11{width:300px;
    height:25px;
    background-color: #EEEEEE;}
.c12{width:300px;
    background-color:white;}
.c13{width:300px;
    background-color:white;}

.u1{width:13.2%;
background-color:#6F6F6F;}
.u2{width:17.6%;
background-color:#6F6F6F;}
.u3{width:13.3%;
background-color:#6F6F6F;}
.u4{width:26.3%;
background-color:#6F6F6F;}
.u5{width:10.7%;
background-color:#6F6F6F;}
.u6{width:;
background-color:#6F6F6F;}

.u1-1{width:244px;
height:25px;}
.u2-1{width:328px;}
.u3-1{width:247px}
.u4-1{width:491px;}
.u5-1{width:198px;}
.u6-1{width:338px;}

.print_button{
        position:fixed; top:97%; left:92.5%;
    	font-family: arial;
        font-size:16px;
        cursor:pointer;
        width:60px;
}
.close_button{
        position:fixed; top:97%; left:96.2%;
    	font-family: arial;
        font-size:16px;
        cursor:pointer;
        width:60px;}
}

</style>

</head>

<body>
<div id="pmchecksheet">
Preventive Maintenance Check Sheet
</div>

<main>
<div class="border">
</div>

<table id="equipinfo" border= "1">
                      {% for equipinfos in equipinfo %}
                      {% for equipinforevs in equipinforev %}
                      {% for pmchecksheet_schs in pmchecksheet_info %}

    <tr>
        <td class="table1">
            Control No.
        </td>
        <td class="table2">
            {{pmchecksheet_schs.controlno}}
        </td>
        <td class="table1">
            Equipment. Name
        </td>
        <td class="table2">
            {{pmchecksheet_schs.name}}
        </td>
    </tr>
    <tr>
        <td class="table1">
            Model Name
        </td>
        <td class="table2">
            {{equipinfos.model}}
        </td>
        <td class="table1">
            Serial No.
        </td>
        <td class="table2">
            {{equipinfos.serial}}
        </td>
    </tr>
    <tr>
        <td class="table1">
            Manufacturer
        </td>
        <td class="table2">
            {{equipinfos.maker}}
        </td>
        <td class="table1">
            Team
        </td>
        <td class="table2">
            {{pmchecksheet_schs.team}}
        </td>
    </tr>
    <tr>
        <td class="table1">
            Room Name&nbsp;(Room No.)
        </td>
        <td class="table2">
            {{pmchecksheet_schs.roomname}}&nbsp;({{pmchecksheet_schs.roomno}})
        </td>
        <td class="table1">
            Revision No. / Revision Date
        </td>
        <td class="table2">
            Rev.{{pmchecksheet_schs.revno}} / {{pmchecksheet_schs.revdate}}
        </td>
    </tr>
    <tr>
        <td class="table1">
             Plan Date / Action Date
        </td>
        <td class="table2">
            {{pmchecksheet_schs.plandate}} / {{pmchecksheet_schs.actiondate_temp}}
        </td>
        <td class="table1">
            PM Sheet No.
        </td>
        <td class="table2">
            {{pmchecksheet_schs.pmsheetno}}
        </td>
    </tr>
                                 {% endfor %}
                                 {% endfor %}
                                 {% endfor %}
</table>

<div id="pmchecksheettitle" >
     <table  style="word-break:break-all">
        <thead>
        <tr>
            <td align="center" class="c1" rowspan="2">Maintenance Item</td>
            <td align="center" class="c2" rowspan="2">Check Standard</td>
            <td align="center" class="c3" rowspan="2">Check Result</td>
            <td align="center" class="c4" colspan="3">Judgement</td>
            <td align="center" class="c5" rowspan="2">Repair Detail</td>
            <td align="center" class="c6" rowspan="2">Work Request</td>
            <td align="center" class="c8" rowspan="2">Used Parts</td>
        </tr>
        <tr>
            <td align="center" class="c7">Pass</td>
            <td align="center" class="c7">Fail_Y</td>
            <td align="center" class="c7">Fail_N</td>
        </tr>
        </thead>
     </table>
</div>

<div id="pmchecksheetdesc">
 <table style="word-break:break-all" border="1" id="pmtable">
                 {%if comp_signal == "N" %}
     <tbody>
                      {% for pmresult in pmchecksheet_before  %}
        <tr>
            <td align="left" class="c1-1">{{pmresult.item}}</td> <!--models.py에서 값받아오기-->
            <td align="left" class="c2-1">{{pmresult.check}}</td>
            <td align="left" class="c3-1"></td>
            <td align="center" class="c7-1"><input type="checkbox" name="judpass"  onclick="return false">
            </td>
            <td align="center" class="c7-1"><input type="checkbox" name="judfaily" onclick="return false">
            </td>
            <td align="center" class="c7-1"><input type="checkbox" name="judfailn" onclick="return false">
            </td>
            <td align="left" class="c5-1"></td>
            <td align="center" class="c6-1"></td>
            <td align="center" class="c6-1"></td>
        </tr>
                             {% endfor %}
        </tbody>
                      {%else%}
          <tbody>
                      {% for pmresult in pmchecksheet_result  %}
        <tr>
            <td align="left" class="c1-1">{{pmresult.item}}</td> <!--models.py에서 값받아오기-->
            <td align="left" class="c2-1">{{pmresult.check}}</td>
            <td align="left" class="c3-1">{{pmresult.result}}</td>
            <td align="center" class="c7-1"><input type="checkbox" name="judpass" {{pmresult.pass_y}} onclick="return false">
            </td>
            <td align="center" class="c7-1"><input type="checkbox" name="judfaily" {{pmresult.fail_y}} onclick="return false">
            </td>
            <td align="center" class="c7-1"><input type="checkbox" name="judfailn" {{pmresult.fail_n}} onclick="return false">
            </td>
            <td align="left" class="c5-1">{{pmresult.actiondetail}}</td>
            <td align="center" class="c6-1">{{pmresult.workrequest}}</td>
            <td align="center" class="c6-1">{{pmresult.usedpart}}</td>
        </tr>
                             {% endfor %}
        </tbody>
                    {%endif%}
 </table>
</div>

 <div id="usedparttop">
    <table id="usedparthead" border="1">
        <tr>
            <td align="center" class="u7" colspan="6">Used Parts List</td>
        </tr>
       <tr>
            <td align="center" class="u1">Code No.</td>
            <td align="center" class="u2">Part Name</td>
            <td align="center" class="u3">Vendor</td>
            <td align="center" class="u4">Model Name</td>
            <td align="center" class="u5">Quantity</td>
            <td align="center" class="u6">Out Code</td>
       </tr>
   </table>
 </div>
 <div id="usedpartbody">
   <table id="usedparttable" border="1">
            {% for spare_out in spare_list %}
       <tr>
            <td align="center" class="u1-1">{{spare_out.codeno}}</td>
            <td align="center" class="u2-1">{{spare_out.partname}}</td>
            <td align="center" class="u3-1">{{spare_out.vendor}}</td>
            <td align="center" class="u4-1">{{spare_out.modelno}}</td>
            <td align="center" class="u5-1">{{spare_out.used_qy}}</td>
            <td align="center" class="u6-1">{{spare_out.out_code}}</td>
       </tr>
            {% endfor %}
   </table>
 </div>

 <div id="pmremarktop">
   <table id="pmremarkhead">
        <tr>
            <td align="center" class="r1">Remark</td>
            <td align="center" class="r2">Attach File</td>
        </tr>
   </table>
 </div>

 <div id="pmremarkbody">
   <table id="pmremarktable"  border="1">
                {% for pmlist in pmchecksheet_info  %}
     <tr>
            <td align="left" class="r1-1">{{pmlist.remark}}</td>
            {% if url_comp == "Y" %}
            <td align="left" class="r2-1">
           <a href="{{pmlist.attach}}" target="_blank" class="upload_complete_css">Upload_ Complete</a>
            </td>
            {%else%}
            <td align="left" class="r2-1">
            <a class="upload_complete_css">N/A</a>
            </td>
            {% endif %}
     </tr>
                   {% endfor %}
   </table>
 </div>

 <div>
 <table style="word-break:break-all" id="pmchecksheetapprovaltop">
     <thead>
         <tr>
            <td align="center">Review & Approved</td>
        </tr>
     </thead>
 </table>

 <table style="word-break:break-all" id="pmchecksheetapproval" border="1">
                     {%if comp_signal == "N" %}
     <tbody>
        <tr>
            <td align="left" class="c11">Performed by:</td> <!--models.py에서 값받아오기-->
            <td align="center" class="c12"></td>
            <td align="center" class="c13"></td>
        </tr>

        <tr>
            <td align="left" class="c11">Reviewed by:</td> <!--models.py에서 값받아오기-->
            <td align="center" class="c12"></td>
            <td align="center" class="c13"></td>
        </tr>
        <tr>
            <td align="left" class="c11">Approved by:</td> <!--models.py에서 값받아오기-->
            <td align="center" class="c12"></td>
            <td align="center" class="c13"></td>
        </tr>
     </tbody>
                {%else%}
         <tbody>
                      {% for pmresult in pmchecksheet_info  %}

        <tr>
            <td align="left" class="c11">Performed by:</td> <!--models.py에서 값받아오기-->
            <td align="center" class="c12">{{pmresult.p_name}}</td>
            <td align="center" class="c13">{{pmresult.p_date}}</td>
        </tr>

        <tr>
            <td align="left" class="c11">Reviewed by:</td> <!--models.py에서 값받아오기-->
            <td align="center" class="c12">{{pmresult.r_name}}</td>
            <td align="center" class="c13">{{pmresult.r_date}}</td>
        </tr>
        <tr>
            <td align="left" class="c11">Approved by:</td> <!--models.py에서 값받아오기-->
            <td align="center" class="c12">{{pmresult.a_name}}</td>
            <td align="center" class="c13">{{pmresult.a_date}}</td>
        </tr>
                    {%endfor%}
        </tbody>
               {%endif%}
 </table>
 </div>
</main>
</div>

<input type="button" class="print_button" value="Print" onclick="print()">
<input type="button" class="close_button" value="Close" onclick="Close();">

<script>
    function Close(){
    self.close();
    }
</script>
</body>
</html>