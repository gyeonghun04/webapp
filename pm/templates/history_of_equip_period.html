<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<style>
.border {
        position:fixed;top:10px;
        border:8px solid #6F6F6F;
        width:549px;
        height:740px;
        z-index:10;
    }
#ra_title{
        margin-top:30px;
        margin-left:40px;
        font-size: 20px;
        font-family: arial;
        font-weight:bold;
}

#equipinfo{
        margin-top:10px;
    	font-family: arial;
        font-size:10px;
        position:relative; left:7px;
        color:black;
        width:551px;
}
#equipinfo_table{
        border:1px solid #6F6F6F;
        border-collapse:collapse;
        -webkit-print-color-adjust: exact !important;
}
#raok{
        position:relative; left:7px;
    	font-family: arial;
        font-size:10px;
        width:551px;
        background-color:#6F6F6F;
        color:white;
        height:20px;
        -webkit-print-color-adjust: exact !important;
}
.table1{
        background-color: #EEEEEE;
        width:97px;
        height:15px;
        font-weight:bold;
        -webkit-print-color-adjust: exact !important;
}
.table2{
        background-color: white;
        width:180px;
}

#raokdesc{
        position:relative; left:7px;
        width:551px;
}
#raoktable{
        border:1px solid #6F6F6F;
        border-collapse:collapse;
        font-size:10px;
        font-family: arial;
        -webkit-print-color-adjust: exact !important;
}
#ratitle{
    	font-family: arial;
        font-size:10px;
        position:relative; left:7px;
        width:551px;
        background-color:#6F6F6F;
        color:white;
        height:20px;
        -webkit-print-color-adjust: exact !important;
}
#radesc{
        position:relative; left:7px;
        width:551px;
}
#ratable{
        border:1px solid #6F6F6F;
        border-collapse:collapse;
        font-size:10px;
        font-family: arial;
        -webkit-print-color-adjust: exact !important;
}
#ramain{
    	font-family: arial;
        font-size:10px;
        position:relative; left:7px;
        width:551px;
        background-color:#6F6F6F;
        color:white;
        height:20px;
        -webkit-print-color-adjust: exact !important;
}
#ramaindesc{
        position:relative; left:7px;
        width:551px;
        height:67%;
}
#ramaintable{
        border:1px solid #6F6F6F;
        border-collapse:collapse;
        font-size:10px;
        font-family: arial;
        -webkit-print-color-adjust: exact !important;
}
#rafooter{
        position:relative; left:7px;
        width:551px;
    	font-family: arial;
        font-size:10px;
        background-color:#6F6F6F;
        color:white;
        height:20px;
        -webkit-print-color-adjust: exact !important;
}
#rafooterdesc{
        position:relative; left:7px;
        width:551px;
        font-family: arial;
        font-size:10px;
        padding-left:5px;
}
#score{
        position:relative; left:7px;
        width:500px;
        border:1px solid #6F6F6F;
        border-collapse:collapse;
        font-size:10px;
        font-family: arial;
        -webkit-print-color-adjust: exact !important;
}
#raresult{
    	font-family: arial;
        font-size:10px;
        position:relative; left:7px;
        width:551px;
        background-color:#6F6F6F;
        color:white;
        height:20px;
        -webkit-print-color-adjust: exact !important;
}
#raresultdesc{
        position:relative; left:7px;
        width:551px;
        font-family: arial;
        font-size:12px;
        padding-left:480px;
        font-weight:bold;
        -webkit-print-color-adjust: exact !important;
}

.a1-1{width:100px; height:20px;}
.a2-1{width:841px; height:20px;}
.a3-1{width:200px; height:20px;}


.c1{width:100px;}

.c1-1{width:100px; height:15px;}
.c2-1{width:1044px; height:15px;}
.c1-2{width:100px; height:90px;}
.c2-2{width:1044px; height:90px;}

.c2{width:100px;}

.t1-1{width:100px; height:20px;}
.t2-1{width:841px; height:20px;}
.t3-1{width:200px; height:20px;}

.t1-2{width:100px; height:70px;}
.t1-3{width:100px; height:70px;}
.t1-4{width:100px; height:30px;}



.c3{width:140px;}
.c4{width:60px;}
.c5{width:100px;}


.c11{width:300px;
    height:21px;
    background-color: #EEEEEE;
    font-weight:bold;}
.c12{width:300px;
    height:15px;
    background-color:white;}
.c13{width:300px;
    height:15px;
    background-color:white;}

#pmcontrolformtop{
        position:relative; left:7px;
        width:551px;
    	font-family: arial;
        font-size:10px;
        background-color:#6F6F6F;
        color:white;
        padding:3px;
        -webkit-print-color-adjust: exact !important;
}

#pmcontrolformapproval{
        position:relative; left:7px;
        width:551px;
        font-family: arial;
        font-size:10px;
        padding:10px;
        border:1px solid #6F6F6F;
        border-collapse:collapse;
        -webkit-print-color-adjust: exact !important;
}
</style>
<body>

<div id="ra_title">
Assessment for Period of Preventive Maintenance
</div>

<div class="border">
</div>
<div id="equipinfo">
<table id="equipinfo_table" border= "1">
                      {% for equipinfos in equipinfo %}
    <tr>
        <td class="table1">
            Control No.
        </td>
        <td class="table2">
            {{equipinfos.controlno}}
        </td>
        <td class="table1">
            Equipment. Name
        </td>
        <td class="table2">
            {{equipinfos.name}}
        </td>
    </tr>
    <tr>
        <td class="table1">
            Model Name
        </td>
        <td class="table2">
            {{equipinfos.model}}
        </td>
        <td class="table1">
            Serial No.
        </td>
        <td class="table2">
            {{equipinfos.serial}}
        </td>
    </tr>
    <tr>
        <td class="table1">
            Manufacturer
        </td>
        <td class="table2">
            {{equipinfos.maker}}
        </td>
        <td class="table1">
            Team
        </td>
        <td class="table2">
            {{equipinfos.team}}
        </td>
    </tr>
    <tr>
        <td class="table1">
            Room Name
        </td>
        <td class="table2">
            {{equipinfos.roomname}}
        </td>
        <td class="table1">
            Room No.
        </td>
        <td class="table2">
            {{equipinfos.roomno}}
        </td>
    </tr>
    {% endfor %}
</table>
</div>

 {% for equipinfos in equipinfo %}
<div id="raok">
<table  style="word-break:break-all">
        <thead>
        <tr>
            <td align="center" class="c5">1. PM Standard</td>
        </tr>
        </thead>
</table>
</div>
<div id="raokdesc">
 <table style="word-break:break-all" border="1" id="raoktable">
     <tbody>
         <tr>
            <td align="center" class="a1-1">Items</td>
            <td align="center" class="a2-1">Description</td>
            <td align="center" class="a3-1">Result</td>
         </tr>
         <tr>

            <td align="center" class="a1-2" height="20">PM<br>Standard</td>
            <td align="left" class="a2-2">{{equipinfos.pmresult}}</td>
            <td align="center" class="a3-2">{{equipinfos.pmok}}</td>

         </tr>
</tbody>
 </table>
</div>

<div id="ratitle" >
     <table  style="word-break:break-all">
        <thead>
        <tr>
            <td align="center" class="c1">2. Assessment Ⅰ</td>
        </thead>
     </table>
</div>
<div id="radesc">
 <table style="word-break:break-all" border="1" id="ratable">
     <tbody>
        <tr>
            <td align="center" class="c1-1">Items</td>
            <td align="center" class="c2-1">Description</td>
        </tr>
         <tr>
            <td align="center" class="c1-2">Equipment<br> Manual</td>
            <td align="left" class="c2-2">
1. “설비 및 컴퓨터의 GxP평가(FE002)” 결과에 따라 PQ 대상 설비로 분류되거나 또는 PM 필요 시 본 평가를 진행하고 그렇지 않으면 ‘N / A’에 표기한다.<br>
(1. If it is classified as a PQ target facility according to the result of “GxP assessment of equipment and computers (FE002)”
                or if necessary, this implementation will be conducted. Otherwise, “Not applicable” is indicated<br>
2. 설비 매뉴얼의 권고사항을 기준으로 주기를 적용하나 그렇지 않으면 아래의 평가 방법을 따른다.<br>
(2. The interval is applied based on the recommendations of the equipment manual, but exceptions <br>follow the interval setting
evaluation method Ⅱ below.)
</td>
</tr>
</tbody>
 </table>
</div>

<div id="ramain" >
     <table  style="word-break:break-all">
        <thead>
        <tr>
            <td align="center" class="c2">3. Assessment Ⅱ</td>
        </thead>
     </table>
</div>
<div id="ramaindesc">
 <table style="word-break:break-all" border="1" id="ramaintable">
     <tbody>
        <tr>
            <td align="center" class="t1-1">Items </td>
            <td align="center" class="t2-1">Description </td>
            <td align="center" class="t3-1">Result (Score) </td>
        </tr>
         <tr>
            <td align="center" class="t1-2">Frequency of<br> use<br>(F)</td>
             <td align="left" class="t2-2">
                 설비의 연간 가동 일수에 따라 설비에 미치는 영향을 주요 변수로 적용.<br>
                The effect of the item on the equipment depending on the frequency of use is applied as the main variable.<br>
                (평가: 1 ~ 90일(1점), 91 ~ 180일(2점), 181 ~ 270일(3점), 271일 이상(4점) )<br>
                (Assessment : 1 ~ 90 days(1 point), 91 ~ 180 days(2 points), 181 ~ 270 days(3 points), 271 days or more(4 points)</td>
            <td align="center" class="t3-2">{{equipinfos.score_f}}point</td>
         </tr>
         <tr>
            <td align="center" class="t1-3">Equipment<br> Manual</td>
             <td align="left" class="t2-3">
                 설비의 사용 연수에 따라 설비에 미치는 영향을 주요 변수로 적용.<br>
                The effect on the equipment is applied as the main variable according to
                the number <br>of years of equipment use.<br>
                (평가: 0 ~ 5년(1점), 6 ~ 10년(2점), 11 ~ 15년(3점), 16년 이상(4점))<br>
                (Assessment : 0 to 5 years(1 point), 6 to 10 years(2 points), 11 to 15 years(3 points),<br>16 years or more(4 points)<br></td>
            <td align="center" class="t3-3">{{equipinfos.score_y}}point</td>
         </tr>
         <tr>
            <td align="center" class="t1-4">Total Score <br> (F + Y)</td>
             <td align="left" class="t2-4"></td>
            <td align="center" class="t3-4">{{equipinfos.pmscore}}point</td>
         </tr>
</tbody>
 </table>
</div>

<div id="rafooter" >
     <table  style="word-break:break-all">
        <thead>
        <tr>
            <td align="center" class="c3">4. Assessment Standard</td>
        </thead>
     </table>
</div>
<div id="rafooterdesc">
 <table style="word-break:break-all" >
     <thead>
        <tr>
            <td align="left">
                합산 점수가 정해지면 PM 주기가 설정된다.<br>
                When the total score is determined, the PM period is set according to the grade.</td>
        </tr>
    </thead>
 </table>
 <table id="score" border="1">
    <tr>
        <td align="center" width="200" height="15">Total Score (F + Y)</td>
        <td align="center" width="150">2</td>
        <td align="center" width="150">3</td>
        <td align="center" width="150">4 ~ 5</td>
        <td align="center" width="150">6 ~ 8</td>
    </tr>
    <tr>
        <td align="center" height="15">PM Period</td>
        <td align="center" >12 Months</td>
        <td align="center" >6 Months</td>
        <td align="center" >3 Months</td>
        <td align="center" >1 Month</td>
    </tr>
 </table>
</div>

<div id="raresult" >
     <table  style="word-break:break-all">
        <thead>
        <tr>
            <td align="center" class="c4">5. Result</td>
        </thead>
     </table>
</div>
<div id="raresultdesc">
 <table style="word-break:break-all">
     <thead>
        <tr>
            {%if pmok == "Y" %}
            <td>{{equipinfos.ra}}Month(s)</td>
            {%else%}
            <td>N/A</td>
            {%endif%}
        </tr>
    </thead>
 </table>
</div>

 <table style="word-break:break-all" id="pmcontrolformtop">
     <thead>
         <tr>
            <td align="center" class="c15">Review & Approved</td>
        </tr>
     </thead>
 </table>
 <table style="word-break:break-all" id="pmcontrolformapproval" border="1">
    <tbody>
        <tr>
            <td align="left" class="c11">Prepared by:</td> <!--models.py에서 값받아오기-->
            <td align="center" class="c12">{{equipinfos.p_name}}</td>
            <td align="center" class="c13">{{equipinfos.p_date}}</td>
        </tr>
        <tr>
            <td align="left" class="c11">Approved by:</td> <!--models.py에서 값받아오기-->
            <td align="center" class="c12">{{equipinfos.a_name}}</td>
            <td align="center" class="c13">{{equipinfos.a_date}}</td>
        </tr>
     </tbody>
 </table>
    {%endfor%}
</table>
</body>

<script>

             //////////// 기본초기값 불러오기//////////////
     function init(){
             window.resizeTo(595,842);
             window.print();
             }
      onload=init

</script>
</html>