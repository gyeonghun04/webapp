<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Rubik:wght@500&display=swap');

header{
        height:30px;
        background:#6F6F6F;
        justify-content:space-between;
        align-items:center;
        position:fixed;
        top:0;
        left:0;
        right:0;
        z-index:10;
        }
header2{
        height:0.3px;
        padding-top:3px;
        background:#EEEEEE;
        display:flex;
        justify-content:space-between;
        position:fixed;
        top:30px;
        left:0;
        right:0;
        z-index:10;
}
#logindata{
        position:fixed; top:1px; left:100px;
        font-family: 'Rubik', sans-serif;
        font-size:18px;
        vertical-align:top;
        font-weight:bold;
        color:white;
}
toptext{
        font-family: 'Rubik', sans-serif;
        font-size:18px;
        vertical-align:top;
        font-weight:bold;
        padding-left:10px;
        color:white;
}
.Button {
        position:fixed; left:1050px;
        font-family:'Rubik', sans-serif;
        font-size:18px;
        background-color: rgba(255, 255, 255, 0.0);
        cursor:pointer;
        border:0px;
        color:white;
        font-weight:bold;
}
#tabletop{
    	font-family: arial;
        position:fixed;top:27px;
        height:30px;
}
titletext{
    	font-family:'Rubik', sans-serif;
        font-size:20px;
        font-weight:bold;
}
.selecttext{
        margin-left:20px;
        width:105px;
        height:20px;
}
.searchtext{
        width:200px;
        height:20px;
}
.searchbutton{
        width:60px;
        height:20px;
        cursor:pointer;
}
#searchbar{
        padding-top:5px;
        font-family:'Rubik', sans-serif;
        font-size:10px;
}

#tablemenu{
    	font-family: arial;
        font-size:11px;
        position:fixed;top:60px;
        height:20px;
        background-color:#6F6F6F;
        color:white;
}
#tabledesc{
        position:absolute;top:80px;
        z-index:10;
        font-family: arial;
        font-size:11px;
        overflow-y:scroll;
        height:340px;
}

.m1{width:70px;}
.m2{width:80px;}
.m3{width:150px;}
.m4{width:100px;}
.m5{width:150px;}
.m6{width:150px;}
.m7{width:100px;}
.m8{width:70px;}
.m9{width:50px;}
.m10{width:80px;}
.m11{width:50px;}

.m1-1{width:70px;
height:20px;}
.m2-1{width:80px;}
.m3-1{width:150px;}
.m4-1{width:100px;}
.m5-1{width:150px;}
.m6-1{width:150px;}
.m7-1{width:100px;}
.m8-1{width:70px;}
.m9-1{width:50px;}
.m10-1{width:80px;}
.m11-1{width:50px;}

body{overflow:hidden;}

tr:nth-child(even){
    background-color:#EEEEEE;
}
#sparesummery{
      position:fixed;top:480px;

}
#sparemenu{
    	font-family: arial;
        font-size:11px;
        position:fixed;top:510px;
        height:20px;
        background-color:#6F6F6F;
        color:white;
}
#sparedesc{
        position:absolute;top:530px;
        z-index:10;
        font-family: arial;
        font-size:11px;
        overflow-y:auto;
        height:200px;
}

#contact_desc{
        position:absolute;top:508px; left:725px;
        z-index:10;
        font-family: arial;
        font-size:11px;
        overflow-y:auto;
}

.n1{width:70px;}
.n2{width:80px;}
.n3{width:130px;}
.n4{width:90px;}
.n5{width:180px;}
.n6{width:50px;}
.n7{width:50px;}

.n1-1{width:70px;
height:20px;}
.n2-1{width:80px;}
.n3-1{width:130px;}
.n4-1{width:90px;}
.n5-1{width:180px;}
.n6-1{width:50px;}
.n7-1{width:50px;}

.req_qy_css{
    font-size:11px;
    font-family:arial;
    width:30px;
}
.v1{
    width:100px;
    background-color:#6F6F6F;
    color:white;
    height:20px;}
.v2{width:80px;
    background-color:#6F6F6F;
    color:white;}
.v3{width:120px;
    background-color:#6F6F6F;
    color:white;}
.v4{width:50px;
    background-color:#6F6F6F;
    color:white;}

.v1-1{width:100px;}
.v2-1{width:80px;}
.v3-1{width:120px;}
.v4-1{width:50px;}

.request_btn{
    position:absolute;top:430px; left:1020px;
    font-family: arial;
    font-size:12px;
    cursor:pointer;
    font-weight:bold;
}
.reset_btn{
    position:absolute;top:430px; left:960px;
    font-family: arial;
    font-size:12px;
    cursor:pointer;
    color:red;
    font-weight:bold;
}
.submit_btn{
    position:absolute;top:740px; left:1035px;
    font-family: arial;
    font-size:12px;
    cursor:pointer;
    font-weight:bold;
    }
#select_radio{
        margin-top:5px;
        margin-left:248px;
        font-family: 'Rubik', sans-serif;
        font-size:11px;
        font-weight:bold;
}
.radio{
        cursor:pointer;
}
.check_box{
        cursor:pointer;
}
.status_btn{
        font-family: arial;
        font-size:10px;
        cursor:pointer;
        width:60px;
}
</style>
</head>
<body>
<header>
<toptext>Welcome,&nbsp;</toptext>
<div id="logindata"></div>

<input type="button"value="Close" class="Button" onclick="Close();">
</header>
<header2>
</header2>

<div id="tabletop" style="word-break:break-all">
<table>
    <tr>
    <td><titletext>Shortage Spare Parts List</titletext></td>
    <td>
    <div id="select_radio">
            <input type="radio" class="radio" name="type" value="total" {{total}} onclick="Select_radio();">Zero&emsp;
            <input type="radio" class="radio" name="type" value="pm" {{pm}} onclick="Select_radio();">PM&emsp;
            <input type="radio" class="radio" name="type" value="short" {{short}} onclick="Select_radio();">Shortage&emsp;
    </div>
    </td>
    <td>
    <div id="searchbar">
        <form action="spareparts_short_main" method="get">
            <select class="selecttext" name="selecttext">&nbsp;
            <option value="vendor">Vendor</option>
            <option value="team">Team</option>
            </select>
            <input type="search"  class="searchtext" value="{{searchtext}}" placeholder="Keywords" name="searchtext">
            <input type="hidden" value="{{loginid}}" name="loginid">
            <input type="hidden" value="{{selecttext}}" name="selecttext">
            <input type="hidden" value="{{searchtext}}" name="searchtext">
            <input type="submit"  class="searchbutton" value="Search"></form>
    </div></td>
    </tr>
</table>
</div>
<div id="tablemenu">
     <table  style="word-break:break-all">
        <thead>
        <tr>
            <td align="center" class="m1">Team</td>
            <td align="center" class="m2">Code No.</td>
            <td align="center" class="m3">Parts Name</td>
            <td align="center" class="m4">Vendor</td>
            <td align="center" class="m5">Model Name</td>
            <td align="center" class="m6">Spec</td>
            <td align="center" class="m7">Location</td>
            <td align="center" class="m8">Shortage QY</td>
            <td align="center" class="m10">Status</td>
            <td align="center" class="m11">Staff</td>
            <td align="center" class="m9">Check</td>
        </tr>
        </thead>
     </table>
</div>
<form action="spareparts_short_request" method="post" name="spareparts_request_form">
        {% csrf_token %}
<div id="tabledesc">
 <table style="word-break:break-all">
     <tbody>
            {% for sp_list in parts_list %}
        <tr>
            <td align="center" class="m1-1">{{sp_list.team}}</td>
            <td align="center" class="m2-1">{{sp_list.codeno}}</td>
            <td align="center" class="m3-1">{{sp_list.partname}}</td>
            <td align="center" class="m4-1">{{sp_list.vendor}}</td>
            <td align="center" class="m5-1">{{sp_list.modelno}}</td>
            <td align="center" class="m6-1">{{sp_list.spec}}</td>
            <td align="center" class="m7-1">{{sp_list.location}}</td>
            {% if pm == "checked" %}
            <td align="center" class="m8-1">{{sp_list.short_qy}}</td>
            {% elif short == "checked" %}
            <td align="center" class="m8-1">{{sp_list.short_qy}}</td>
            {% else %}
            <td align="center" class="m8-1">{{sp_list.safety_stock}}</td>
            {%endif%}
            <td align="center" class="m10-1">
                <input type="button"  value="{{sp_list.status}}" name="status" class="status_btn" onclick="Status_change(this);"></td>
            <td align="center" class="m11-1">{{sp_list.status_staff}}</td>
            <td align="center" class="m9-1">
                <input type="checkbox" class="check_box" name="checks[]"  value="{{sp_list.codeno}}" {{sp_list.contact_y_n}}>
                <input type="hidden" value="{{sp_list.no}}" name="no_up">
            </td>
        </tr>
            {% endfor %}
        </tbody>
 </table>
 </div>
<input type="hidden" name="loginid">
<input type="hidden" name="total" value="{{total}}">
<input type="hidden" name="pm" value="{{pm}}">
<input type="hidden" name="type" value="{{type}}">
<input type="hidden" name="short" value="{{short}}">
<input type="submit" class="request_btn" value="Request"></form>

<form action="spareparts_short_main" method="post" name="spareparts_request_reset">
        {% csrf_token %}
<input type="hidden" name="loginid">
 <input type="submit" class="reset_btn" value="Reset"></form>

<div id="sparesummery">
        <titletext>Request Spare Parts</titletext>
</div>
<div id="sparemenu">
     <table  style="word-break:break-all">
        <thead>
        <tr>
            <td align="center" class="n1">Team</td>
            <td align="center" class="n2">Code No.</td>
            <td align="center" class="n3">Parts Name</td>
            <td align="center" class="n4">Vendor</td>
            <td align="center" class="n5">Model Name</td>
            <td align="center" class="n7">S_QY</td>
            <td align="center" class="n6">QY</td>
        </tr>
        </thead>
     </table>
</div>

<form action="spareparts_short_submit" method="post" name="spareparts_submit_form">
      {% csrf_token %}
<div id="sparedesc">
 <table style="word-break:break-all">
     <tbody>
            {% for sp_list in spare_check %}
        <tr>
            <td align="center" class="n1-1">{{sp_list.team}}</td>
            <td align="center" class="n2-1">{{sp_list.codeno}}</td>
            <td align="center" class="n3-1">{{sp_list.partname}}</td>
            <td align="center" class="n4-1">{{sp_list.vendor}}</td>
            <td align="center" class="n5-1">{{sp_list.modelno}}</td>
            {% if pm == "checked" %}
            <td align="center" class="n7-1">{{sp_list.short_qy}}</td>
            {% elif short == "checked" %}
            <td align="center" class="n7-1">{{sp_list.short_qy}}</td>
            {% else %}
            <td align="center" class="n7-1">{{sp_list.safety_stock}}</td>
            {%endif%}
            <td align="center" class="n6-1">
                <input type="hidden" name="codeno[]" value="{{sp_list.codeno}}">
                <input type="text" class="req_qy_css" name="req_qy[]">
            </td>
        </tr>
            {% endfor %}
        </tbody>
 </table>
</div>

<div id="contact_desc">
    <table>
        <thead>
        <tr>
            <td align="center" class="v1">Vendor</td>
            <td align="center" class="v2">Name</td>
            <td align="center" class="v3">e-mail</td>
            <td align="center" class="v4">check</td>
        </tr>
        </thead>
        <tbody>
                {% for vendorlists in vendorlist %}
         <tr>
            <td align="center" class="v1-1">{{vendorlists.vendor}}</td>
            <td align="center" class="v2-1">{{vendorlists.name}}</td>
            <td align="center" class="v3-1">{{vendorlists.email}}</td>
            <td align="center" class="v4-1">
                <input type="checkbox" class="check_box" name="email_chk[]" value="{{vendorlists.no}}">
                <input type="hidden" value="{{vendorlists.no}}" name="no_up"></td>
        </tr>
                {%endfor%}
        </tbody>
    </table>
</div>
    <input type="hidden" name="loginid">
    <input type="hidden" name="type" value="{{type}}">
    <input type="hidden" name="total" value="{{total}}">
    <input type="hidden" name="short" value="{{short}}">
    <input type="hidden" name="pm" value="{{pm}}">
    <input type="submit"  class="submit_btn" value="e-mail" onclick="this.disabled=true;this.value='e-mail'; this.form.submit();"></form>
<input type="hidden" value="{{email_comp}}" name="email_comp">


<form method="get" name="spareparts_short_type">
<input type="hidden" name="type">
</form>

<form method="post" name="status_change_form">
    {% csrf_token %}
    <input type="hidden" name="type" value="{{type}}">
    <input type="hidden" name="total" value="{{total}}">
    <input type="hidden" name="pm" value="{{pm}}">
    <input type="hidden" name="short" value="{{short}}">
    <input type="hidden" name="no">
    <input type="hidden" name="loginid">
</form>

<script>
     function init(){
            loginid = opener.document.getElementById("loginid_up").value;
            var loginid_up = loginid;
            document.spareparts_request_form.loginid.value = loginid_up;
            document.spareparts_submit_form.loginid.value = loginid_up;
            document.status_change_form.loginid.value = loginid_up;
            document.getElementById("logindata").innerHTML=loginid_up;
            var close_signal= document.getElementsByName('email_comp')[0].value;
            if (close_signal=="Y"){
                window.resizeTo(600,200);
                alert("Your email has been sent.");
                opener.document.location.reload();
                self.close();}
            }

      onload=init

    function Close(){
            self.close();
    }

    function Select_radio(){
                     // type 값보내기
           var obj_length = document.getElementsByName("type").length;
                for (var i=0; i<obj_length; i++) {
                    if (document.getElementsByName("type")[i].checked == true) {
                        var type = document.getElementsByName("type")[i].value;
                        }
                    }
           document.spareparts_short_type.type.value = type;
                           // 서버연결
           document.spareparts_short_type.action="spareparts_short_main";
           document.spareparts_short_type.submit();
    }

    function Status_change(obj){
                    // 행위치값과 플랜데이트 받기
            var i = obj.parentNode.parentNode.rowIndex;
            var no = document.getElementsByName('no_up')[i].value;
            document.status_change_form.no.value = no;
            document.status_change_form.action="spareparts_short_status";
            document.status_change_form.submit();
    }
</script>
</body>
</html>