<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/xeicon@2.3.3/xeicon.min.css">
    <title>Title</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Rubik:wght@500&display=swap');

header{
        height:30px;
        background:#6F6F6F;
        justify-content:space-between;
        align-items:center;
        position:fixed;
        top:0;
        left:0;
        right:0;
        z-index:10;
        }
header2{
        height:0.3px;
        padding-top:3px;
        background:#EEEEEE;
        display:flex;
        justify-content:space-between;
        position:fixed;
        top:30px;
        left:0;
        right:0;
        z-index:10;
}
toptext{
        font-family: 'Rubik', sans-serif;
        font-size:18px;
        vertical-align:top;
        font-weight:bold;
        padding-left:5px;
        color:white;
}
#logindata{
        position:fixed; top:1px; left:90px;
        font-family: 'Rubik', sans-serif;
        font-size:18px;
        vertical-align:top;
        font-weight:bold;
        color:white;
}
l{
        margin-left:1%;
        color:white;
}
m{
        margin-left:1%;
        color:white;
}
k{
        position:fixed; top:0%; left:94.5%;
        color:white;
}
.Button {
        position:fixed; left:760px;
        font-family:'Rubik', sans-serif;
        font-size:18px;
        background-color: rgba(255, 255, 255, 0.0);
        cursor:pointer;
        border:0px;
        color:white;
        font-weight:bold;
}
pm{
        position:fixed; top:35px; left:5px;
        font-family: 'Rubik', sans-serif;
        font-size:18px;
        font-weight:bold;
}
#table_location{
        position:fixed; top:70px; left:5px;
}
.text_css{
      font-family:'Rubik', sans-serif;
      font-size:13px;
      color:black;
      background-color:#D8D8D8;
      width:130px;
      height:25px;
      }
.input_css{
      font-size:13px;
      width:350px;
      height:25px;
}
.maint_select{
      font-size:13px;
      width:358px;
      height:25px;
      }

.location_btn{
        margin-top:11px;
    	font-family: arial;
        font-size:12px;
        cursor:pointer;
}
.submit_btn{
    	font-family: arial;
        font-size:12px;
        cursor:pointer;
        position:fixed; top:680px; left:760px;
}
#pmcontrol_call_top{
        position:fixed; top:240px; left:6px;
}
#pmcontrol_call_comp{
        position:fixed; top:266px; left:6px;
        height:400px;
        overflow-y:scroll;
        }
#pmcontrol_call{
        position:fixed; top:266px; left:6px;
        height:400px;
        overflow-y:scroll;
        }
.pm_table{
        border:1px solid #6F6F6F;
        border-collapse:collapse;
        font-size:12px;
        font-family:arial;
}
.top_css{
        height:25px;
        font-size:12px;
        font-weight:bold;
        color:white;
        background-color:#6F6F6F;}
.t1{width:100px;}
.t2{width:170px;}
.t3{width:150px;}
.t4{width:250px;}
.t6{width:45px;}
.t5{width:65px;}

.t1-1{width:100px;
    height:25px;}
.t2-1{width:170px;}
.t3-1{width:150px;}
.t4-1{width:250px;}
.t6-1{width:50px;}
.t5-1{width:50px;}
tr:nth-child(even){
    background-color:#EEEEEE;
}

#messages_location{
        position:fixed; top:5px; left:250px;
        font-size:18px;
        font-weight:bold;
        animation-iteration-count:10;
	    animation-duration:1s;
	    animation-name: changecolor;
       	color:#6F6F6F;
       	}

@keyframes changecolor{
    from{
       	  color:white;    }
    to{
          color:red;    }
}
.no_css{
      font-size:13px;
      width:30px;
}
comp_text{
      font-family:'Rubik', sans-serif;
      font-size:13px;
      color:blue;
      position:fixed; top:680px; left:5px;
      }
</style>
</head>

<body>
<header>
<toptext>Welcome,&nbsp;</toptext>
<div id="logindata"></div>

<div id="messages_location">
{%if messages %}
{%for message in messages%}
{{message}}
{%endfor%}
{%endif%}
</div>

<input type="button"value="Close" class="Button" onclick="Close();">

</header>
<header2>
</header2>
<pm>PM Parts Registration</pm>
<div id="table_location">
   <table>
        <tr>
            <td align="center" class="text_css">Control No.</td>
            <td align="left">
            <input type="text" name="controlno_get"  placeholder="Enter Control No." value="{{controlno_get}}" class="input_css" onchange="Control_no();"></td>
        </tr>
        <tr>
            <td align="center" class="text_css">Equipment Name</td>
            <td align="left">
            <input type="text" name="equip_get"  value="{{equip_get}}" class="input_css" readonly></td>
        </tr>
        <tr>
            <td align="center" class="text_css" rowspan="2">Maintenance Item</td>
            <td align="left">
            <select class="maint_select" name="maint_item" onchange="Maint_select();">
            <option value="None"></option>
                {% for pm_lists in pm_list %}
            <option value="{{pm_lists.itemcode}}">{{pm_lists.item}}</option>
                {% endfor %}
            </select></td>
        </tr>
        <tr>
            <td align="left">
            <input type="text" name="item_get"  value="{{item_get}}" class="input_css" readonly></td>
        </tr>
        <tr>
            <td align="center" class="text_css">Frequency</td>
            <td align="left">
            <input type="text" name="freq_get"  value="{{freq_get}}" class="input_css" readonly></td>
        </tr>
   </table>
</div>

<div id="pmcontrol_call_top">
    <table  class="top_css">
        <tr>
            <td align="center" class="t1">Code No.</td>
            <td align="center" class="t2">Part Name</td>
            <td align="center" class="t3">Vendor</td>
            <td align="center" class="t4">Model Name</td>
            <td align="center" class="t6">Check</td>
            <td align="left" class="t5">&emsp;QY</td>
        </tr>
    </table>
</div>
 {% if view_signal == "Y" %}
<form action="partslist_pm_maint_submit" method="post">
        {% csrf_token %}
<div id="pmcontrol_call">
    <table class="pm_table" border="1">
                {% for pm_call in spare_list %}
        <tr>
            <td align="center" class="t1-1">{{pm_call.codeno}}</td>
            <td align="center" class="t2-1">{{pm_call.partname}}</td>
            <td align="center" class="t3-1">{{pm_call.vendor}}</td>
            <td align="center" class="t4-1">{{pm_call.modelno}}</td>
            <td align="center" class="t6-1">
                <input type="checkbox" name="checks[]" value="{{pm_call.codeno}}">
                <input type="hidden" value="" name="no_up">
            </td>
            <td align="center" class="t5-1">
              <input type="text" name="qy_get[]"  class="no_css">
            </td>
        </tr>
                {% endfor %}
   </table>
</div>
<input type="hidden" value="{{controlno_get}}" name="controlno">
<input type="hidden" value="{{item_get}}" name="item_get">
<input type="hidden" value="{{loginid}}" name="loginid">
<input type="hidden" value="{{equip_get}}" name="equipname">
<input type="hidden" value="{{maint_item}}" name="maint_item">
<input type="hidden" value="{{freq_get}}" name="freq_get">
<input type="submit" class="submit_btn" value="Submit"></form>
 {% elif view_signal == "Comp" %}
<div id="pmcontrol_call_comp">
    <table class="pm_table" border="1">
                {% for pm_call in part_list %}
        <tr>
            <td align="center" class="t1-1">{{pm_call.codeno}}</td>
            <td align="center" class="t2-1">{{pm_call.partname}}</td>
            <td align="center" class="t3-1">{{pm_call.vendor}}</td>
            <td align="center" class="t4-1">{{pm_call.modelno}}</td>
            <td align="center" class="t6-1">
            <input type="checkbox" checked>
            </td>
            <td align="center" class="t5-1">{{pm_call.qy}}</td>
        </tr>
                {% endfor %}
   </table>
</div>
<comp_text>Registration is complete.</comp_text>

    {%endif%}
<input type="hidden" value="{{comp_signal}}" name="comp_signal">

<form name="controlno_form" method="post">
    {% csrf_token %}
    <input type="hidden" name="loginid">
    <input type="hidden" name="controlno">
</form>

<form name="maint_item_form" method="post">
    {% csrf_token %}
    <input type="hidden" name="loginid">
    <input type="hidden" name="maint_item">
    <input type="hidden" name="controlno">
    <input type="hidden" name="equipname">
</form>

<form name="call_item_form" method="post">
    {% csrf_token %}
    <input type="hidden" name="maint_item" id="maint_item_up">
    <input type="hidden" name="controlno" id="controlno_up">
</form>

<form name="controlno_submit_form" method="post">
    {% csrf_token %}
    <input type="hidden" name="loginid">
    <input type="hidden" name="controlno_get">
    <input type="hidden" name="controlno">
</form>
    <input type="hidden" value="{{loginid}}" id="loginid_up">
<script>

    //////////// 기본초기값 불러오기//////////////
     function init(){
            loginid = opener.document.getElementById("loginid_up").value;
       ////아이디 정보 보내기
            var loginid_up = loginid;
            document.getElementById("logindata").innerHTML=loginid_up;
            var close_signal= document.getElementsByName('comp_signal')[0].value;
            if (close_signal=="Y"){
                alert("PM Maintenance Item Registration is complete.");
                opener.document.location.reload();
                self.close();}
            }

      onload=init

    function Close(){
    opener.document.location.reload();
    self.close();
    }

    function Control_no(){
            var controlno= document.getElementsByName('controlno_get')[0].value;
            loginid = opener.document.getElementById("loginid_up").value;
                // 값보내기
            document.controlno_form.loginid.value = loginid;
            document.controlno_form.controlno.value = controlno;
                // 서버연결
            document.controlno_form.action="partslist_pm_controlno";
            document.controlno_form.submit();
                }

    function Maint_select(){
            var controlno= document.getElementsByName('controlno_get')[0].value;
            var maint_item= document.getElementsByName('maint_item')[0].value;
            loginid = opener.document.getElementById("loginid_up").value;
            equip_get= document.getElementsByName('equip_get')[0].value;
                // 값보내기
            document.maint_item_form.loginid.value = loginid;
            document.maint_item_form.maint_item.value = maint_item;
            document.maint_item_form.controlno.value = controlno;
            document.maint_item_form.equipname.value = equip_get;
                // 서버연결
            document.maint_item_form.action="partslist_pm_maint_item";
            document.maint_item_form.submit();
                }

</script>
</body>
</html>